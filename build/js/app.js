/*! JeuHeure 2014-11-26 */
"use strict";var Clock=function(a){var b,c,d=this,e=new Image,f=new Image,g=new Image;d.construct=function(a){d.init(a)},d.init=function(a){console.log(a),("undefined"==typeof a||null==a||""==a)&&(a="img/clock1.png"),b=new Kinetic.Stage({container:"clock",width:400,height:400}),d.setHeureMinute(),c=new Kinetic.Layer,e.src=a,e.onload=function(){var a=new Kinetic.Image({width:400,height:400,image:e,draggable:!1});c.add(a),c.draw()},g.src="img/firstHand.png",g.onload=function(){console.log(d.minutes);var a=new Kinetic.Image({x:198,y:192,offsetX:3,offsetY:3,width:6,height:120,rotation:180+6*d.minutes,image:g});c.add(a),c.draw()},f.src="img/secondHand.png",f.onload=function(){console.log(d.heures);var a=new Kinetic.Image({x:198,y:192,width:6,height:80,offsetX:3,offsetY:3,rotation:180+30*d.heures+.5*d.minutes,image:f});c.add(a),c.draw()},b.add(c),c.draw()},d.getTimeDay=function(){return d.heures>=12?"apr√®s-midi":"matin"},d.getHeures=function(){return d.heures},d.getMinutes=function(){return d.minutes},d.setHeureMinute=function(){d.heures=Math.round(24*Math.random()),d.minutes=5*Math.round(Math.random()/5*60),60==d.minutes&&(d.heures+=1,d.minutes=0),24==d.heures&&(d.heures=0)},d.checkTime=function(a,b){return a==d.heures&&b==d.minutes?!0:!1},d.construct(a)},hourApp=angular.module("hourApp",["ngRoute","ngAnimate","ngDialog"]);hourApp.config(["$routeProvider",function(a){a.when("/game",{templateUrl:"partials/game.html",controller:"gameController"}).when("/options",{templateUrl:"partials/options.html",controller:"optionsController"}).when("/credits",{templateUrl:"partials/credits.html"}).when("/",{templateUrl:"partials/home.html",controller:"homeController"}).otherwise({redirect:"/home"})}]),hourApp.controller("gameController",["$scope","$rootScope","ngDialog",function(a,b,c){a.clock={},a.clock=new Clock(b.pathImg),a.timeDay=a.clock.getTimeDay(),a.heures=a.clock.getHeures(),a.minutes=a.clock.getMinutes(),a.clientHeures=0,a.clientMinutes=0,a.hourUp=function(){23==a.clientHeures?a.clientHeures=0:a.clientHeures+=1},a.hourDown=function(){0==a.clientHeures?a.clientHeures=23:a.clientHeures-=1},a.minuteUp=function(){55==a.clientMinutes?a.clientMinutes=0:a.clientMinutes+=5},a.minuteDown=function(){0==a.clientMinutes?a.clientMinutes=55:a.clientMinutes-=5},a.verify=function(){console.log(a.clock.checkTime(a.clientHeures,a.clientMinutes)),c.open(a.clock.checkTime(a.clientHeures,a.clientMinutes)?{template:"partials/win.html",scope:a}:{template:"partials/loose.html",scope:a})},a.playAgain=function(){a.clock={},a.clock=new Clock,a.timeDay=a.clock.getTimeDay(),a.clientMinutes=0,a.clientHeures=0}}]),hourApp.controller("optionsController",["$scope","$rootScope",function(a,b){a.changeClock=function(a){b.pathImg=a}}]),hourApp.controller("homeController",["$scope","$rootScope",function(){}]);